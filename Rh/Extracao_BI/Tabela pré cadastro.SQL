SELECT
	 FKCODCOLIGADA = CONVERT(VARCHAR,GCOLIGADA.CODCOLIGADA)
	,FKCODFUNCAO = CONVERT(VARCHAR, PRECAD.CODCOLIGADA) + '_' + ISNULL(CONVERT(VARCHAR, PFUNCAO.CODFUNCAO), 'N/A')
	,PKCHAPA = CONVERT(VARCHAR, PRECAD.CODCOLIGADA) + '_' + UPPER(CONVERT(VARCHAR(25), PFUNC.CHAPA))
	,[Data de admiss√£o] = UPPER(CONVERT(VARCHAR(25), PRECAD.DATAADMISSAO))
  	,[Nome do Funcionario] = UPPER(CONVERT(VARCHAR(255), PPESSOA.NOME))
	
FROM PFUNCPRELIMINAR PRECAD (NOLOCK)
	INNER JOIN PPESSOA
	    ON PRECAD.CODPESSOA = PPESSOA.CODIGO
    INNER JOIN GCOLIGADA 
        ON GCOLIGADA.CODCOLIGADA = PRECAD.CODCOLIGADA
    INNER JOIN PFUNCAO
        ON PRECAD.CODFUNCAO = PFUNCAO.CODIGO
    LEFT JOIN PFUNC
        ON PFUNC.CHAPA = PRECAD.CHAPA
        
	
	
